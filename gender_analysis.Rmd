---
title: "Master data cleaning"
output:
  html_document:
    df_print: paged
---

```{r}
library(vroom) 
library(plyr)
library(ggplot2)
library(psych)
library(tidyverse)
library(OpenMx)
library(stringr)
library(dplyr)
```
# Purpose of this notebook
Create summary variables for the FLASHE foods and the parenting practices.
Need to create the summary variables for the questions related to "when your main caregiver was not around"
From Table 2. Summary of food groups, variable computation, and variable names for daily intake frequency in the FLASHE user guide

## Naming convention
NAMEFOODGROUP_iEO
Example: SSB_iEO

# Read in the data
```{r}
df<-vroom("/Users/gracer/OneDrive - University of Wyoming/0. Lab/M2AENAD Lab - Documents/RESEARCH/multi-state/master_data/2. data/Qualtrics+Pilot-Actual+2020-Parent-Child+Dyad+Survey_December+21,+2021_09.21.csv")
df<-df[-c(1), ] # remove extra header row
head(df[, c(15:203)])
names(df)
```
# Read in codebook
```{r}
code_df<-vroom("/Users/gracer/OneDrive - University of Wyoming/0. Lab/M2AENAD Lab - Documents/RESEARCH/multi-state/master_data/2. data/Codebook.csv")
head(code_df)
```
# Find the independent and non-independent eating variables
```{r}
depend_vars <-code_df %>%
  filter(!str_detect(Survey_item, "not around?"))


independ_vars <-code_df %>%
  filter(str_detect(Survey_item, "not around?"))
independ_vars
```

```{r}
#df<-df[,c(16, 24,28, 36:203, 274:308,353:358, 361, 368:371, 342:348, 365,372:377) ]  # variables of interest
#add_keep<-c('Q6.24','Q6.25','Q6.26','Q6.27','Q6.28','Q6.29', 'Q6.20','Q1.5')
#head(df)
```
# Diet data
Cols 42-203
From table 1 FLASHE guide - Drinks into drinks per day
From table 2

## SSB
soda + energy drinks + sweetened
fruit drinks + sports drinks
```{r}
SSB_vars <- code_df%>%
  filter(str_detect(Survey_item, "SWEETENED FRUIT DRINKS") | str_detect(Survey_item, "SODA") | str_detect(Survey_item, "ENERGY DRINKS") | str_detect(Survey_item, "SPORTS DRINKS"))

SSB_SODA_vars<- SSB_vars %>%
  filter(str_detect(Survey_item, "SODA"))
SSB_SWEET_vars<- SSB_vars %>%
  filter(str_detect(Survey_item, "SWEETENED FRUIT DRINKS"))
SSB_ENERGY_vars<- SSB_vars %>%
  filter(str_detect(Survey_item, "ENERGY DRINKS"))
SSB_SPORT_vars<- SSB_vars %>%
  filter(str_detect(Survey_item, "SPORTS DRINKS"))

SSB_independ_vars <-independ_vars %>%
  filter(str_detect(Survey_item, "SWEETENED FRUIT DRINKS") | str_detect(Survey_item, "SODA") | str_detect(Survey_item, "ENERGY DRINKS") | str_detect(Survey_item, "SPORTS DRINKS"))

SSB_depend_vars <-depend_vars %>%
  filter(str_detect(Survey_item, "SWEETENED FRUIT DRINKS") | str_detect(Survey_item, "SODA") | str_detect(Survey_item, "ENERGY DRINKS") | str_detect(Survey_item, "SPORTS DRINKS"))

```
```{r}
df1<-df %>%
  mutate_at(c(SSB_SWEET_vars$Variable_name), funs(recode(.,
                              'I did not drink sweetened fruit drinks during the past 7 days' = 0,                
                              'I did not drink sweetened fruit drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>% 
  mutate_at(c(SSB_SODA_vars$Variable_name), funs(recode(.,
                              'I did not drink soda during the past 7 days' = 0,
                              'I did not drink soda when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c(SSB_ENERGY_vars$Variable_name), funs(recode(.,
                              'I did not drink energy drinks during the past 7 days' = 0,
                              'I did not drink energy drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c(SSB_SPORT_vars$Variable_name), funs(recode(.,
                              'I did not drink sports drinks during the past 7 days' = 0,
                              'I did not drink sports drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))

```


```{r SSB conversion}
df0<-df %>%
  mutate(across(c('Q2.6','Q2.12','Q2.18','Q2.24','Q2.30','Q2.36','Q2.13','Q2.14','Q2.15','Q2.16','Q2.17'),
                factor))

df1<-df0 %>%
  mutate_at(c('Q2.6','Q2.7','Q2.8','Q2.9','Q2.10','Q2.11'), funs(recode(.,
                              'I did not drink sweetened fruit drinks during the past 7 days' = 0,                
                              'I did not drink sweetened fruit drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c('Q2.12','Q2.13','Q2.14','Q2.15','Q2.16','Q2.17'), funs(recode(.,
                              'I did not drink 100% pure fruit juice during the past 7 days' = 0,
                              'I did not drink 100% pure fruit juice when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c('Q2.18','Q2.19','Q2.20','Q2.21','Q2.22','Q2.23'), funs(recode(.,
                              'I did not drink soda during the past 7 days' = 0,
                              'I did not drink soda when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c('Q2.24','Q2.25','Q2.26','Q2.27','Q2.28','Q2.29'), funs(recode(.,
                              'I did not drink energy drinks during the past 7 days' = 0,
                              'I did not drink energy drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c('Q2.30','Q2.31','Q2.32','Q2.33','Q2.34','Q2.35'), funs(recode(.,
                              'I did not drink sports drinks during the past 7 days' = 0,
                              'I did not drink sports drinks when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c('Q2.36','Q2.37','Q2.38','Q2.39','Q2.40','Q2.41'), funs(recode(.,
                              'I did not drink water during the past 7 days' = 0,
                              'I did not drink water when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))
```

## Junk Foods
candy/chocolate + cookies/cake +
potato chips + fried potatoes +
frozen desserts
```{r}
JUNK_vars <- code_df %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "POTATO CHIPS") | str_detect(Survey_item, "FRIED POTATOES") | str_detect(Survey_item, "FROZEN DESSERTS"))


JUNK_CANDY_vars<- JUNK_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE"))
JUNK_CAKE_vars<- JUNK_vars %>%
  filter(str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS"))
JUNK_CHIPS_vars<- JUNK_vars %>%
  filter(str_detect(Survey_item, "POTATO CHIPS"))
JUNK_FRIES_vars<- JUNK_vars %>%
  filter(str_detect(Survey_item, "FRIED POTATOES "))
JUNK_FROZE_vars<- JUNK_vars %>%
  filter(str_detect(Survey_item, "FROZEN DESSERTS"))

JUNK_independ_vars <-independ_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "POTATO CHIPS") | str_detect(Survey_item, "FRIED POTATOES") | str_detect(Survey_item, "FROZEN DESSERTS"))

JUNK_depend_vars <-depend_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "POTATO CHIPS") | str_detect(Survey_item, "FRIED POTATOES") | str_detect(Survey_item, "FROZEN DESSERTS"))
```

```{r Junk food conversion}
df2<-df1 %>%
  mutate_at(c(JUNK_CANDY_vars$Variable_name), funs(recode(.,
                              'I did not eat candy or chocolate during the past 7 days' = 0,                                         
                              'I did not eat candy or chocolate when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(JUNK_CAKE_vars$Variable_name), funs(recode(.,
                              'I did not eat any of these during the past 7 days' = 0,                                         
                              'I did not eat any of these when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(JUNK_FROZE_vars$Variable_name), funs(recode(.,
                              'I did not eat frozen desserts during the past 7 days' = 0,                                         
                              'I did not eat frozen desserts when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(JUNK_CHIPS_vars$Variable_name), funs(recode(.,
                              'I did not eat chips during the past 7 days' = 0,                                         
                              'I did not eat chips when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(JUNK_FRIES_vars$Variable_name), funs(recode(.,
                              'I did not eat fried potatoes during the past 7 days' = 0,                                         
                              'I did not eat fried potatoes when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) 

```
## Sugary Foods
frozen dessert + cookies/cake +
candy/chocolate + sugary cereal

```{r}
SUGAR_vars <- code_df %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "SUGARY CEREALS") | str_detect(Survey_item, "FROZEN DESSERTS"))


SUGAR_CANDY_vars<- SUGAR_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE"))
SUGAR_CAKE_vars<- SUGAR_vars %>%
  filter(str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS"))
SUGAR_CEREAL_vars<- SUGAR_vars %>%
  filter(str_detect(Survey_item, "SUGARY CEREALS"))
SUGAR_FROZE_vars<- SUGAR_vars %>%
  filter(str_detect(Survey_item, "FROZEN DESSERTS"))

SUGAR_independ_vars <-independ_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "SUGARY CEREALS") | str_detect(Survey_item, "FROZEN DESSERTS"))

SUGAR_depend_vars <-depend_vars %>%
  filter(str_detect(Survey_item, "CANDY OR CHOCOLATE") | str_detect(Survey_item, "COOKIES, CAKES, CUPCAKES, DOUGHNUTS, BROWNIES, POP-TARTS") | str_detect(Survey_item, "SUGARY CEREALS") | str_detect(Survey_item, "FROZEN DESSERTS"))
SUGAR_independ_vars
```

```{r sugar cereal conv}
df3<-df2 %>%
  mutate_at(c(SUGAR_CEREAL_vars$Variable_name), funs(recode(.,
                              'I did not eat sugary cereals during the past 7 days' = 0,                                         
                              'I did not eat sugary cereals when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) 
View(df3)
```
## Fast/Convenience Foods
fried potatoes + fried chicken +
pizza + tacos + burgers + heat and serve
```{r}
FAST_vars<-code_df %>%
  filter(str_detect(Survey_item, "FRIED POTATOES") | str_detect(Survey_item, "HEAT AND SERVE") |  str_detect(Survey_item, "FRIED CHICKEN") | str_detect(Survey_item, "PIZZA") | str_detect(Survey_item, "TACOS, BURRITOS, NACHOS")| str_detect(Survey_item, "HAMBURGERS OR CHEESEBURGERS"))


FAST_FRIES_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "FRIED POTATOES"))
FAST_HEAT_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "HEAT AND SERVE"))
FAST_CHICK_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "FRIED CHICKEN"))
FAST_PIZZA_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "PIZZA"))
FAST_TACOS_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "TACOS, BURRITOS, NACHOS"))
FAST_BURGER_vars<- FAST_vars %>%
  filter(str_detect(Survey_item, "HAMBURGERS OR CHEESEBURGERS"))

FAST_independ_vars <-independ_vars %>%
  filter(str_detect(Survey_item, "FRIED POTATOES") | str_detect(Survey_item, "HEAT AND SERVE") | str_detect(Survey_item, "FRIED CHICKEN") | str_detect(Survey_item, "PIZZA") | str_detect(Survey_item, "TACOS, BURRITOS, NACHOS")| str_detect(Survey_item, "HAMBURGERS OR CHEESEBURGERS"))

FAST_depend_vars <-depend_vars %>%
  filter(str_detect(Survey_item, "FRIED POTATOES ") | str_detect(Survey_item, "HEAT AND SERVE") | str_detect(Survey_item, "FRIED CHICKEN") | str_detect(Survey_item, "PIZZA") | str_detect(Survey_item, "TACOS, BURRITOS, NACHOS")| str_detect(Survey_item, "HAMBURGERS OR CHEESEBURGERS"))
```

```{r convenience foods conv}
df4<-df3 %>%
  mutate_at(c(FAST_CHICK_vars$Variable_name), funs(recode(.,
                              'I did not eat fried chicken during the past 7 days' = 0,                                         
                              'I did not eat fried chicken when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FAST_BURGER_vars$Variable_name), funs(recode(.,
                              'I did not eat hamburgers or cheeseburgers during the past 7 days' = 0,                                       
                              'I did not eat hamburgers or cheeseburgers when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FAST_HEAT_vars$Variable_name), funs(recode(.,
                              'I did not eat foods that you heat and serve during the past 7 days' = 0,                                     
                              'I did not eat foods that you heat and serve when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c(FAST_TACOS_vars$Variable_name), funs(recode(.,
                              'I did not eat these dishes food during the past 7 days' = 0,                                     
                              'I did not eat these dishes when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))%>%
  mutate_at(c(FAST_PIZZA_vars$Variable_name), funs(recode(.,
                              'I did not eat pizza during the past 7 days' = 0,                                     
                              'I did not eat pizza when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))
```
## Fruits and vegetables
100% fruit juice + fruit + green salad
+ other non-fried vegetables +
cooked beans + other potatoes
```{r}
FV_vars <- code_df %>%
  filter(str_detect(Survey_item, "100% PURE FRUIT JUICE") | str_detect(Survey_item, "FRUIT like") | str_detect(Survey_item, "GREEN SALAD") | str_detect(Survey_item, "NON-FRIED VEGETABLES") | str_detect(Survey_item, "COOKED BEANS")| str_detect(Survey_item, "OTHER KIND OF POTATOES"))


FV_JUICE_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "100% PURE FRUIT JUICE"))
FV_FRUIT_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "FRUIT like"))
FV_SALAD_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "GREEN SALAD"))
FV_VEGGIES_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "NON-FRIED VEGETABLES") )
FV_BEANS_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "COOKED BEANS"))
FV_POTATO_vars<- FV_vars %>%
  filter(str_detect(Survey_item, "OTHER KIND OF POTATOES"))

FV_independ_vars <-independ_vars %>%
  filter(str_detect(Survey_item, "100% PURE FRUIT JUICE") | str_detect(Survey_item, "FRUIT like") | str_detect(Survey_item, "GREEN SALAD") | str_detect(Survey_item, "NON-FRIED VEGETABLES") | str_detect(Survey_item, "COOKED BEANS")| str_detect(Survey_item, "OTHER KIND OF POTATOES"))

FV_depend_vars <-depend_vars %>%
  filter(str_detect(Survey_item, "100% PURE FRUIT JUICE") | str_detect(Survey_item, "FRUIT like") | str_detect(Survey_item, "GREEN SALAD") | str_detect(Survey_item, "NON-FRIED VEGETABLES") | str_detect(Survey_item, "COOKED BEANS")| str_detect(Survey_item, "OTHER KIND OF POTATOES"))
```


```{r fruit+veg conversion}
df5<-df4 %>%
  mutate_at(c(FV_FRUIT_vars$Variable_name), funs(recode(.,
                              'I did not eat fruit during the past 7 days' = 0,                                   
                              'I did not eat fruit when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FV_SALAD_vars$Variable_name), funs(recode(.,
                              'I did not eat green salad during the past 7 days' = 0,                             
                              'I did not eat green salad when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FV_POTATO_vars$Variable_name), funs(recode(.,
                              'I did not eat non-fried potatoes during the past 7 days' = 0,                      
                              'I did not eat non-fried potatoes when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FV_VEGGIES_vars$Variable_name), funs(recode(.,
                              'I did not eat non-fried vegetables during the past 7 days' = 0,                    
                              'I did not eat non-fried vegetables when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
  mutate_at(c(FV_BEANS_vars$Variable_name), funs(recode(.,
                              'I did not eat cooked beans during the past 7 days' = 0,                    
                              'I did not eat cooked beans when my main caregiver was not around' = 0,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3))) %>%
mutate_at(c(FV_JUICE_vars$Variable_name), funs(recode(.,
                              'I did not drink 100% pure fruit juice during the past 7 days' = 0,
                              'I did not drink 100% pure fruit juice when my main caregiver was not around' = 0,
                              '1 \xd0 3 times in the past 7 days' = 0.29,
                              '4 \xd0 6 times in the past 7 days' = 0.71,
                              '1-3 times in the past 7 days' = 0.29,
                              '4-6 times in the past 7 days' = 0.71,
                              '1 time per day' = 1,
                              '2 times per day' = 2,
                              '3 or more times per day' = 3)))
```
# Freq total
```{r frequencies}
df5$SSB_iEO_freq<-rowSums(df5[SSB_independ_vars$Variable_name], na.rm = TRUE)
df5$SUGAR_iEO_freq<-rowSums(df5[SUGAR_independ_vars$Variable_name], na.rm = TRUE)
df5$FAST_iEO_freq<-rowSums(df5[FAST_independ_vars$Variable_name], na.rm = TRUE)
df5$JUNK_iEO_freq<-rowSums(df5[JUNK_independ_vars$Variable_name], na.rm = TRUE)
df5$FV_iEO_freq<-rowSums(df5[FV_independ_vars$Variable_name], na.rm = TRUE)

df5$SSB_freq<-rowSums(df5[SSB_depend_vars$Variable_name], na.rm = TRUE)
df5$SUGAR_freq<-rowSums(df5[SUGAR_depend_vars$Variable_name], na.rm = TRUE)
df5$FAST_freq<-rowSums(df5[FAST_depend_vars$Variable_name], na.rm = TRUE)
df5$JUNK_freq<-rowSums(df5[JUNK_depend_vars$Variable_name], na.rm = TRUE)
df5$FV_freq<-rowSums(df5[FV_depend_vars$Variable_name], na.rm = TRUE)
View(df5)
```

# Need to create a food parenting practice constructs

See codebook

```{r}
Parent_vars <- code_df %>%
  filter(str_detect(Survey_item, "I give my child ideas about how to eat healthy") | str_detect(Survey_item, "I help my child set goals to eat healthy foods") | str_detect(Survey_item, "I teach my child to read nutrition labels on foods to decide what to eat") | str_detect(Survey_item, "I ask my child to suggest how he/she can eat healthy foods") | str_detect(Survey_item, "I praise my child for eating healthy food")| str_detect(Survey_item, "I teach my child to eat and drink certain foods and drinks")| str_detect(Survey_item, "I teach my child about healthy portions to limit how much he/she eats")| str_detect(Survey_item, "I remind my child that it is important to eat healthy")| str_detect(Survey_item, "I make my child text or call me to get permission to eat certain foods") | str_detect(Survey_item, "I call or text to make sure my child does not eat unhealthy foods/drinks")| str_detect(Survey_item, "I call or text to make sure my child eats healthy foods/drinks")| str_detect(Survey_item, "I let my child know that I am keeping track of what he/she eats/drinks")| str_detect(Survey_item, "I offer rewards to get my child to eat healthy foods")| str_detect(Survey_item, "I tell my child I don't like it when he/she does not eat healthy foods")| str_detect(Survey_item, "I make sure that I have healthy foods/drinks at home for my child")| str_detect(Survey_item, "I have healthy foods at home that my child can eat or prepare for himself/herself")| str_detect(Survey_item, "buy the healthy foods and drinks that my child likes so he/she can eat/drink them")| str_detect(Survey_item, "I prepare food for my child so that he/she will eat healthy meals/snacks")| str_detect(Survey_item, "I avoid having unhealthy foods/drinks available at home for my child")| str_detect(Survey_item, "I allow my child to buy unhealthy foods to eat")| str_detect(Survey_item, "I don't mind if my child eats sweets and salty snacks")| str_detect(Survey_item, "I buy unhealthy foods for my child to eat")| str_detect(Survey_item, "I allow my child to prepare something else if he/she doesn't like what's available")| str_detect(Survey_item, "I let my child help decide what he/she eats or prepares")| str_detect(Survey_item, "I avoid TV/electronic devices (phone, iPad, etc.) during family meals so my child will do the same")| str_detect(Survey_item, "I talk to my child about not watching TV or using his/her electronic devices while eating")| str_detect(Survey_item, "I tell my child to avoid unhealthy foods/drinks")| str_detect(Survey_item, "I tell my child to eat healthy foods/drinks"))

autonomy_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I give my child ideas about how to eat healthy") | str_detect(Survey_item, "I help my child set goals to eat healthy foods") | str_detect(Survey_item, "I teach my child to read nutrition labels on foods to decide what to eat") | str_detect(Survey_item, "I ask my child to suggest how he/she can eat healthy foods") | str_detect(Survey_item, "I praise my child for eating healthy food")| str_detect(Survey_item, "I teach my child to eat and drink certain foods and drinks")| str_detect(Survey_item, "I teach my child about healthy portions to limit how much he/she eats")| str_detect(Survey_item, "I remind my child that it is important to eat healthy"))

monitoring_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I make my child text or call me to get permission to eat certain foods") | str_detect(Survey_item, "I call or text to make sure my child does not eat unhealthy foods/drinks")| str_detect(Survey_item, "I call or text to make sure my child eats healthy foods/drinks")| str_detect(Survey_item, "I let my child know that I am keeping track of what he/she eats/drinks")| str_detect(Survey_item, "I offer rewards to get my child to eat healthy foods")| str_detect(Survey_item, "I tell my child I don't like it when he/she does not eat healthy foods"))

availability_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I make sure that I have healthy foods/drinks at home for my child")| str_detect(Survey_item, "I have healthy foods at home that my child can eat or prepare for himself/herself")| str_detect(Survey_item, "buy the healthy foods and drinks that my child likes so he/she can eat/drink them")| str_detect(Survey_item, "I prepare food for my child so that he/she will eat healthy meals/snacks")| str_detect(Survey_item, "I avoid having unhealthy foods/drinks available at home for my child"))

indulgence_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I allow my child to buy unhealthy foods to eat")| str_detect(Survey_item, "I don't mind if my child eats sweets and salty snacks")| str_detect(Survey_item, "I buy unhealthy foods for my child to eat")| str_detect(Survey_item, "I allow my child to prepare something else if he/she doesn't like what's available")| str_detect(Survey_item, "I let my child help decide what he/she eats or prepares"))

modeling_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I avoid TV/electronic devices (phone, iPad, etc.) during family meals so my child will do the same")| str_detect(Survey_item, "I talk to my child about not watching TV or using his/her electronic devices while eating"))


expectations_vars<-Parent_vars %>%
  filter(str_detect(Survey_item, "I tell my child to avoid unhealthy foods/drinks")| str_detect(Survey_item, "I tell my child to eat healthy foods/drinks"))
```



```{r recode parenting to numeric}
df6<-df5 %>%
  mutate_at(c(Parent_vars$Variable_name), funs(recode(.,                                                                                                                  'Never' = 1,'Sometimes' = 2,'About half the time' = 3,'Most of the time' = 4,'Always' = 5))) 

```

# Parent means
```{r mean parent factors}
df6$AUTONOMY<-rowMeans(df6[autonomy_vars$Variable_name], na.rm = TRUE)
df6$MONITORING<-rowMeans(df6[monitoring_vars$Variable_name], na.rm = TRUE)
df6$AVAILABILITY<-rowMeans(df6[availability_vars$Variable_name], na.rm = TRUE)
df6$INDULGENCE<-rowMeans(df6[indulgence_vars$Variable_name], na.rm = TRUE)
df6$MODELING<-rowMeans(df6[modeling_vars$Variable_name], na.rm = TRUE)
df6$EXPECTATIONS<-rowMeans(df6[expectations_vars$Variable_name], na.rm = TRUE)

```

# Child's view of parent
```{r}
Child_vars <- code_df %>%
  filter(
    str_detect(Survey_item, "gives me ideas on how to eat healthy") | str_detect(Survey_item, "reminds me that it's important to eat healthy") | str_detect(Survey_item, "helps me set goals to eat healthy") | str_detect(Survey_item, "praises me for eating healthy food") | str_detect(Survey_item, "teaches me not to eat some foods and drinks") | str_detect(Survey_item, "teaches me to read nutrition labels on food to decide what to eat") | str_detect(Survey_item, "teaches me about healthy portions to limit how much I eat")| str_detect(Survey_item, "teaches me to eat some foods and drinks")| str_detect(Survey_item, "wants me to eat fruits and vegetables")| str_detect(Survey_item, "asks me to suggest how I can eat healthier")| 
           str_detect(Survey_item, "calls or texts me to make sure I do not eat unhealthy foods/drinks") | str_detect(Survey_item, "calls or texts me to make sure I eat healthy foods/drinks") | str_detect(Survey_item, "wants me to text or call him/her to get permission to eat certain foods") | str_detect(Survey_item, "lets me know that he/she is keeping track of what I eat/drink") | 
           str_detect(Survey_item, "buys healthy foods and drinks I like so I can eat/drink them") | str_detect(Survey_item, "makes sure there are healthy foods at home that I can eat or make for myself")| str_detect(Survey_item, "makes sure that I have healthy foods at home that I like")| 
           str_detect(Survey_item, "allows me to buy unhealthy foods")| str_detect(Survey_item, "OK with me eating too much food")| str_detect(Survey_item, "buys unhealthy foods for me to eat")| 
           str_detect(Survey_item, "talks to me about not watching TV/using electronic devices when I eat")| str_detect(Survey_item, "avoids TV and using a phone during meals so that I will do the same when I'm eating") | str_detect(Survey_item, "eats or drinks healthy foods/drinks in front of me so I will eat/drink healthy foods/drinks")| 
           str_detect(Survey_item, "what I have eaten")| str_detect(Survey_item, "tells me to eat healthy foods/drinks")| str_detect(Survey_item, "tells me to avoid unhealthy foods/drinks")
         )

autonomy_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "gives me ideas on how to eat healthy") | str_detect(Survey_item, "reminds me that it's important to eat healthy") | str_detect(Survey_item, "helps me set goals to eat healthy") | str_detect(Survey_item, "praises me for eating healthy food") | str_detect(Survey_item, "teaches me not to eat some foods and drinks") | str_detect(Survey_item, "teaches me to read nutrition labels on food to decide what to eat") | str_detect(Survey_item, "teaches me about healthy portions to limit how much I eat")| str_detect(Survey_item, "teaches me to eat some foods and drinks")| str_detect(Survey_item, "wants me to eat fruits and vegetables")| str_detect(Survey_item, "asks me to suggest how I can eat healthier"))

monitoring_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "calls or texts me to make sure I do not eat unhealthy foods/drinks") | str_detect(Survey_item, "calls or texts me to make sure I eat healthy foods/drinks") | str_detect(Survey_item, "wants me to text or call him/her to get permission to eat certain foods") | str_detect(Survey_item, "lets me know that he/she is keeping track of what I eat/drink"))

availability_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "buys healthy foods and drinks I like so I can eat/drink them") | str_detect(Survey_item, "makes sure there are healthy foods at home that I can eat or make for myself")| str_detect(Survey_item, "makes sure that I have healthy foods at home that I like"))

indulgence_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "allows me to buy unhealthy foods")| str_detect(Survey_item, "OK with me eating too much food")| str_detect(Survey_item, "buys unhealthy foods for me to eat"))

modeling_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "talks to me about not watching TV/using electronic devices when I eat")| str_detect(Survey_item, "avoids TV and using a phone during meals so that I will do the same when I'm eating") | str_detect(Survey_item, "eats or drinks healthy foods/drinks in front of me so I will eat/drink healthy foods/drinks"))

expectations_child_vars<-Child_vars %>%
  filter(str_detect(Survey_item, "what I have eaten")| str_detect(Survey_item, "tells me to eat healthy foods/drinks")| str_detect(Survey_item, "tells me to avoid unhealthy foods/drinks"))
```


```{r recode parenting to numeric}
df7<-df6 %>%
  mutate_at(c(Child_vars$Variable_name), funs(recode(.,                                                                                                                  'Never' = 1,'Rarely' = 2,'Sometimes' = 3,'Very often' = 4,'Always' = 5))) 
```

# Mean child view of parent
```{r mean child factors}
df7$AUTONOMY_child<-rowMeans(df7[autonomy_child_vars$Variable_name], na.rm = TRUE)
df7$MONITORING_child<-rowMeans(df7[monitoring_child_vars$Variable_name], na.rm = TRUE)
df7$AVAILABILITY_child<-rowMeans(df7[availability_child_vars$Variable_name], na.rm = TRUE)
df7$INDULGENCE_child<-rowMeans(df7[indulgence_child_vars$Variable_name], na.rm = TRUE)
df7$MODELING_child<-rowMeans(df7[modeling_child_vars$Variable_name], na.rm = TRUE)
df7$EXPECATIONS_child<-rowMeans(df7[expectations_child_vars$Variable_name], na.rm = TRUE)
```

## Parent gender
```{r}
summary(as.factor(df7$Q6.11))
df7$parent_gender<-as.factor(df7$Q6.11)
```

## Education
```{r}
summary(as.factor(df7$Q6.14))
df7$parent_ED<-as.factor(df7$Q6.14)
```

## Income
```{r}
summary(as.factor(df7$Q6.17))
df7$INCOME<-as.factor(df7$Q6.17)
```

## Race ethnicity
Change to
Q6.19 or 18
Q6.7 or 6.6
```{r}
summary(as.factor(df7$Q6.19))
summary(as.factor(df7$Q6.19_6_TEXT))
df7$selfreport_race<-as.factor(df7$Q6.19) 
df7$selfreport_ethnicity<-as.factor(df7$Q6.18) 

summary(as.factor(df7$Q6.7))
summary(as.factor(df7$Q6.7_6_TEXT))
df7$parentreport_race_child<-as.factor(df7$Q6.7) 

summary(as.factor(df7$Q6.6))
df7$parentreport_ethnicitiy_child<-as.factor(df7$Q6.6) 
```
### Fill in parent race
Hispanic       Latina       Latino      Mexican   Mixed race        Multi Puerto Rican       West 3         NA's 
          11            2            1            4            1            1            4            1          597 
### Fill in child race
asian American           Asian American                Bi-racial half asian and caucasian                 Hispanic 
                       1                        3                        1                        1                        9 
                  Latino                  Mexican                    Mixed           Mixed blindian                    Multi 
                       3                        3                        1                        1                        1 
            Puerto Rican                     NA's 
                       4                      594 

```{r}
summary(as.factor(df7$Q1.21_4))
df9<-df7 %>% 
  unite("RACE_ETH", Q1.21_1:Q1.21_6, remove = FALSE,na.rm = TRUE)

summary(as.factor(df9$RACE_ETH))

df9$RACE_ETH<-plyr::revalue(df9$RACE_ETH, c("White/Caucasian"=1, 
                   "Asian"=2,
                   "Asian_Black/African American"=3,
                   "Asian_Black/African American_Native American"=4,
                   "Asian_Hawaiian/Pacific Islander"=5,
                   "Asian_Hawaiian/Pacific Islander_White/Caucasian"=6,
                   "Asian_Hispanic/Latino"=7,
                   "Asian_White/Caucasian"=8,
                   "Black/African American"=9,
                   "Black/African American_Hawaiian/Pacific Islander_Hispanic/Latino_Native American"=10,
                   "Black/African American_Hispanic/Latino"=11,
                   "Black/African American_Hispanic/Latino_Native American_White/Caucasian"=12,
                   "Black/African American_Hispanic/Latino_White/Caucasian"=13,
                   "Black/African American_White/Caucasian"=14,
                   "Hawaiian/Pacific Islander"=15,
                   "Hawaiian/Pacific Islander_Hispanic/Latino"=16,
                   "Hawaiian/Pacific Islander_White/Caucasian"=17,
                   "Hispanic/Latino"=18,
                   "Hispanic/Latino_Native American"=19,
                   "Hispanic/Latino_Native American_White/Caucasian"=20,
                   "Hispanic/Latino_White/Caucasian"=21,
                   "Native American"=22,
                   "Native American_White/Caucasian"=23))
summary(as.factor(df9$RACE_ETH))
df9$RACE_ETH<-as.numeric(as.character(df9$RACE_ETH))
```

## Adolescent age
```{r}
summary(as.factor(df9$Q6.2))

df10<-df9 %>%
  mutate_at(c('Q6.2'), funs(recode(.,                                                                                                                  '11 years' = 11,'12 years' = 12,'13 years' = 13,'14 years' = 14
                  ))) 

df10$child_AGE<-df10$Q6.2
```
# Child sex
```{r}
summary(as.factor(df10$Q6.3))
df10$child_SEX<-as.factor(df10$Q6.3)
summary(df10$child_SEX)
df10$child_SEX<-plyr::revalue(df10$child_SEX, c("Boy" = 0, "Girl" = 1))
df10$child_SEX<-as.numeric(as.character(df10$child_SEX))
```

### Other covariates: marital status, food security, parent gender, parent education, parent income, iEO
```{r}
#Q6.20 marital status
# Food security 
#Q6.24<-Often true (1) Sometimes true (2) Never true (3) Don't know or prefer not to answer (4)
#Q6.25<-Often true (1) Sometimes true (2) Never true (3) Don't know or prefer not to answer (4)
#Q6.26<-Yes (1) No (2) Don't know (3)
#Q6.27<-Almost every month (1) Some months but not every month (2) Only 1 or 2 months (3) Don't know (4)
#Q6.28<-Yes (1) No (2) Don't know (3)
#Q6.29<-Yes (1) No (2) Don't know (3)
df11<-df10 %>%
  dplyr::mutate_at(c('Q6.24','Q6.25','Q6.26','Q6.27','Q6.28','Q6.29'), funs(recode(.,
                              'No' = 0,
                              'Yes' = 1,
                              'Almost every month' = 1,
                              'Only 1 or 2 months' = 0,
                              'Some months but not every month'= 1,
                              'Never true' = 0,
                              'Often true'= 1,
                              'Sometimes true'= 1)))

df11<-df11 %>%
  mutate(FOOD_SEC = rowSums(select(.,'Q6.24','Q6.25','Q6.26','Q6.27','Q6.28','Q6.29'), na.rm=TRUE))
df11$FOOD_SEC_CAT <- cut(df11$FOOD_SEC,
              breaks=c(0, 1, 4, 7),
              labels = c(1, 2, 3), right=FALSE)
df11$FOOD_SEC_CAT<-as.numeric(as.character(df11$FOOD_SEC_CAT))

df12<-df11 %>%
  dplyr::mutate_at(c('Q6.20'), funs(recode(.,
                              'Married/Cohabitating' = 0,
                              'Single' = 1)))
df12$Q6.20<-as.numeric(as.character(df12$Q6.20))

#scaled to per day
df13<-df12 %>%
  dplyr::mutate_at(c('Q1.5'), funs(recode(.,
                              '1-2 times per week' = 0.142,
                              '3-4 times per week' = 0.428,
                              '5-6 times per week' = 0.714,
                              'Once a day' = 1,
                              '2 or more times a day' = 2)))

df14<-df13 %>%
  dplyr::mutate_at(c('Q6.10'), funs(recode(.,
                              '18-25' = 1,
                              '26-34' = 2,
                              '35-54' = 3,
                              '55-64' = 4)))


df15<-df14 %>% rename(., 'MARITAL' = 'Q6.20', 'iEO'='Q1.5', 'PARENT_AGE'='Q6.10')

df15<-df15%>%
  dplyr::mutate_at(c('parent_gender'), funs(recode(.,
                              'Female' = 1,
                              'Male' = 0)))
summary(df15$parent_ED)
df15<-df15%>%
  dplyr::mutate_at(c('parent_ED'), funs(recode(.,
                              'Have not completed high school' = 0,
                              'Received high school diploma or GED' = 1,
                              'Some college or technical school' = 2,
                              '4-year college, university degree or advanced degree'=3)))

summary(df15$INCOME)
df15<-df15%>%
  dplyr::mutate_at(c('INCOME'), funs(recode(.,
                              'Below $25,000' = 0,                 
                              '$25,000 - $44,999' = 1,
                              '$45,000 - $64,999' = 2,
                              '$65,000 - $84,999' = 3,
                              '$85,000 or more'=4)))

```

```{r}
#interest<-c("SSB_freq","JUNK_freq","SWEET_freq","FAST_freq","FV_freq","INDULGENCE","EXPECATION", "AVAILABILE","MONITORING","AUTONOMY","MODELING","parent_gender", "parent_ED","INCOME","child_SEX","RACE_ETH", "MARITAL", "FOOD_SEC_CAT", "iEO")
#final_df<-df15[interest]
#head(final_df)
```








```{r}
write.table(df15, "/Users/gracer/OneDrive - University of Wyoming/0. Lab/M2AENAD Lab - Documents/RESEARCH/multi-state/master_data/2. data/master_df.csv", row.names = F, sep = ",")
```

```{r}
#load(file = "/Users/gracer/Library/CloudStorage/OneDrive-SharedLibraries-UniversityofWyoming/M2AENAD Lab - Documents/RESEARCH/multi-state/data/cleaningv1.RData")
```





```{r}
#save.image(file = "/Users/gracer/OneDrive - University of Wyoming/0. Lab/M2AENAD Lab - Documents/RESEARCH/multi-state/master_data/2. data/master_3723.RData")
```

v1 is the dataset with the monitoring fixed